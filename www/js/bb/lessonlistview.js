(function(){CATS.bb.LessonListView=CATS.bb.BaseView.extend({tagName:"div",className:"lessonindex viewbox",localizeid:"lessonindex",category:"school",initialize:function(o){this.constructor.__super__.initialize.apply(this,[o]);return this.listenTo(Backbone,"updatelesson",this.update)},render:function(){var lang,lessondef,lessonid,lessons,list,listitems;this.setContent(CATS.cache.templates["#lessonlisttemplate"]);this.lessonLinkAware();this.setTitle("lessonlistheadline",true);this.setUI("lessonlist","lessonintro");lang=CATS.settings.lang;lessons=CATS.school.lessons;listitems=[];for(lessonid in lessons){lessondef=lessons[lessonid];listitems.push(this.lessonLink(lessonid))}list=$("<div class='davidlist'>"+listitems.join("")+"</div>");this.ui.lessonlist.append(list);this.update();return this},update:function(){var finishedcount,lang,str,totalcount;lang=CATS.settings.lang;totalcount=CATS.texts.count.lessons;finishedcount=CATS.school.numberOfLearnedLessons();str="lessonintro"+function(){switch(totalcount-finishedcount){case 0:return"all";case 1:return"allbutone";case totalcount:return"none";default:return"some"}}();this.ui.lessonintro.setText(str);this.ui.lessonintro.html(this.ui.lessonintro.html().replace("%FINISHED",CATS.texts.numberStr(finishedcount,lang)));return this.ui.lessonintro.html(this.ui.lessonintro.html().replace("%NUM",CATS.texts.numberStr(totalcount,lang)))}})}).call(this);