(function(){CATS.bb.stepview=CATS.bb.BaseView.extend({tagName:"tr",className:"stepview",template:"<td><span class='rownum'></span></td><td class='explanation'><span class='steptoggle'></span><span class='toolname'></span><span class='because'></span></td><td class='before'></td><td class='change'></td><td class='after'></td>",events:{"click .someclass":"toggle"},initialize:function(o,rownum,path){this.o=o;this.rownum=rownum;this.path=path;return this.constructor.__super__.initialize.apply(this,[o])},render:function(){var after,because,before,change,prepath,prepathcalc,toolname,view,viewname,_ref;prepathcalc=function(dug){var i,pathpart,ret,_i,_len,_ref,_results;if(dug==null){dug=[]}ret=[];_ref=o.path;_results=[];for(i=_i=0,_len=_ref.length;_i<_len;i=++_i){pathpart=_ref[i];if(i>=dug.length){_results.push(ret.push(pathpart))}else{_results.push(void 0)}}return _results};prepath=prepathcalc(this.path);before=new CATS.bb.doubleview(CATS.math.lookUp(this.o.before,this.path||{}),prepath,this.o.beforemarks);change=new CATS.bb.stepseparatorview(this.o);after=new CATS.bb.doubleview(CATS.math.lookUp(this.o.after,this.path||{}),prepath,this.o.aftermarks);toolname=new CATS.bb.toolnameview(this.o.who);because=new CATS.bb.textview("because",this.o.because,"en");this.childViews={before:before,change:change,after:after,toolname:toolname,because:because};this.$el.html(this.template);_ref=this.childViews;for(viewname in _ref){view=_ref[viewname];this.$("."+viewname).append(view.render().el)}return this},toggle:function(){return this.$el.toggleClass("xray")}})}).call(this);