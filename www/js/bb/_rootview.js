(function(){CATS.bb.RootView=CATS.bb.BaseView.extend({rootMe:function(root){this.$el.addClass("root").attr("data-root",root);this.$el.on("click","a.wordlink",this.goToWord);this.$el.on("click","a.toollink",this.goToTool);this.$el.on("click","a.infolink",this.goToInfo);this.$el.on("click",".helplink",this.goToHelp);this.$el.on("click","a.lessonlink",this.goToLesson);this.$el.on("click",".schoolintrolink",this.goToSchoolStart);this.$el.on("click",".killstacktabbutton",this.popStack);this.$el.on("showcalcresult",this.showCalcResult);this.stack=[];this.rootname=root;return this},initialize:function(o){_.bindAll(this,"goToWord","goToTool","goToLesson","goToInfo","goToHelp","goToSchoolStart","popStack","showCalcResult");this.listenTo(Backbone,"mainnav",this.clearAll);return this.idme()},clearAll:function(section){if(section===this.rootname){console.log("CLEARING ROOT",this.rootname);return this.stack=[]}},popStack:function(double){this.stack.pop();if(double){return console.log("Navigated to last, so went back instead! now",this.stack)}else{return console.log("Went back, now: ",this.stack)}},goToWord:function(e){return this.link(e,"word")},goToTool:function(e){return this.link(e,"tool")},goToLesson:function(e){return this.link(e,"lesson")},goToInfo:function(e){return this.link(e,"info")},goToHelp:function(e){return this.link(e,"help")},goToSchoolStart:function(e){return this.link(e,"schoolstart")},link:function(e,category){var constructors,data,goal,view,_base;constructors={word:CATS.bb.WordView,tool:CATS.bb.ToolinfoView,lesson:CATS.bb.LessonView,info:CATS.bb.InfoItemView,help:CATS.bb.HelpItemView,schoolstart:CATS.bb.SchoolStartView};data=$(e.currentTarget).attr("linkto");goal=category+data;e.stopPropagation();e.preventDefault();if(this.stack.length&&this.stack[this.stack.length-1]===goal){return}if(this.stack.length&&this.stack[this.stack.length-2]===goal){this.currentview.killMeFromRoot();return this.popStack(true)}this.stack.push(goal);console.log("ROOOT",category,data,this.stack);view=new constructors[category];if(typeof(_base=view.render()).showItem==="function"){_base.showItem(data)}return this.stackView(view)},stackView:function(view){var rootname;view.$el.addClass("sequencehiddenright sequence nonrootview");view.$el.css({"background-color":"white","z-index":5});this.$el.append(view.$el);rootname=this.rootname;view.listenTo(Backbone,"mainnav",function(section){console.log("KILLMEMAYBE",section,rootname);if(section===rootname){return view.killMeFromRoot()}});setTimeout(function(){return view.$el.removeClass("sequencehiddenright")},30);return this.currentview=view},showCalcResult:function(e,obj){var resultview;console.log("CALCRESULT",e,obj);this.stack.push("EXAMPLE");resultview=new CATS.bb.ResultView;resultview.render().show(obj.result,obj.dec,void 0,!!obj.dec);return this.stackView(resultview)}})}).call(this);